@import "tailwindcss";

/* include utility classes in streamdown */
@source '../node_modules/streamdown/dist/index.js';

/* Add KaTeX CSS for math rendering */
@import 'katex/dist/katex.min.css';

/* FlowToken animations for streaming text */
@import 'flowtoken/dist/styles.css';

/* custom variant for setting dark mode programmatically */
@custom-variant dark (&:is(.dark, .dark *));

/* include plugins */
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

/* define design tokens (light mode) */
:root {
  --background: hsl(0 0% 100%);
  --foreground: hsl(240 10% 3.9%);
  --card: hsl(0 0% 98%);
  --card-foreground: hsl(240 10% 3.9%);
  --popover: hsl(0 0% 99%);
  --popover-foreground: hsl(240 10% 3.9%);
  --primary: hsl(240 5.9% 10%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(240 4.8% 93%);
  --secondary-foreground: hsl(240 5.9% 10%);
  --muted: hsl(240 4.8% 96%);
  --muted-foreground: hsl(240 3.8% 46.1%);
  --accent: hsl(240 4.8% 90%);
  --accent-foreground: hsl(240 5.9% 10%);
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(240 5.9% 88%);
  --input: hsl(240 5.9% 92%);
  --ring: hsl(240 10% 3.9%);
  --chart-1: hsl(12 76% 61%);
  --chart-2: hsl(173 58% 39%);
  --chart-3: hsl(197 37% 24%);
  --chart-4: hsl(43 74% 66%);
  --chart-5: hsl(27 87% 67%);
  --sidebar-background: hsl(0 0% 97%);
  --sidebar-foreground: hsl(240 5.3% 26.1%);
  --sidebar-primary: hsl(240 5.9% 10%);
  --sidebar-primary-foreground: hsl(0 0% 98%);
  --sidebar-accent: hsl(240 4.8% 94%);
  --sidebar-accent-foreground: hsl(240 5.9% 10%);
  --sidebar-border: hsl(220 13% 89%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
  /* border radius unit */
  --radius: 0.5rem;
  --sidebar: hsl(0 0% 96%);
  --brand: oklch(0.623 0.214 259.815);
  --highlight: oklch(0.852 0.199 91.936);
}

/* define design tokens (dark mode) */
.dark {
  --background: hsl(240 10% 3.9%);
  --foreground: hsl(0 0% 98%);
  --card: hsl(240 8% 8%);
  --card-foreground: hsl(0 0% 98%);
  --popover: hsl(240 9% 6%);
  --popover-foreground: hsl(0 0% 98%);
  --primary: hsl(0 0% 98%);
  --primary-foreground: hsl(240 5.9% 10%);
  --secondary: hsl(240 3.7% 18%);
  --secondary-foreground: hsl(0 0% 98%);
  --muted: hsl(240 3.7% 12%);
  --muted-foreground: hsl(240 5% 64.9%);
  --accent: hsl(240 4% 22%);
  --accent-foreground: hsl(0 0% 98%);
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(240 3.7% 18%);
  --input: hsl(240 3.7% 14%);
  --ring: hsl(240 4.9% 83.9%);
  --chart-1: hsl(220 70% 50%);
  --chart-2: hsl(160 60% 45%);
  --chart-3: hsl(30 80% 55%);
  --chart-4: hsl(280 65% 60%);
  --chart-5: hsl(340 75% 55%);
  --sidebar-background: hsl(240 5.9% 10%);
  --sidebar-foreground: hsl(240 4.8% 95.9%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(240 3.7% 16%);
  --sidebar-accent-foreground: hsl(240 4.8% 95.9%);
  --sidebar-border: hsl(240 3.7% 17%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
  --sidebar: hsl(240 5.9% 11%);
  --brand: oklch(0.707 0.165 254.624);
  --highlight: oklch(0.852 0.199 91.936);
}

/* Slate theme */
:root[data-theme="slate"],
:root[data-theme="slate"] .dark {
  --chart-1: hsl(220 70% 50%);
  --chart-2: hsl(160 60% 45%);
  --chart-3: hsl(30 80% 55%);
  --chart-4: hsl(280 65% 60%);
  --chart-5: hsl(340 75% 55%);
}

:root[data-theme="slate"] {
  --primary: hsl(215 20% 25%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(215 15% 92%);
  --accent: hsl(215 20% 88%);
  --muted: hsl(215 15% 95%);
  --border: hsl(215 15% 86%);
  --input: hsl(215 15% 90%);
  --ring: hsl(215 20% 25%);
  --sidebar-background: hsl(215 15% 96%);
  --sidebar-accent: hsl(215 15% 93%);
  --sidebar-border: hsl(215 15% 88%);
}

:root[data-theme="slate"] .dark {
  /* Themed backgrounds - very subtle tint */
  --background: hsl(215 8% 5%);
  --card: hsl(215 6% 8%);
  --popover: hsl(215 6% 6%);
  /* Nearly neutral foregrounds for readability */
  --foreground: hsl(215 5% 96%);
  --card-foreground: hsl(215 5% 96%);
  --popover-foreground: hsl(215 5% 96%);
  /* Improved contrast accents */
  --primary: hsl(215 30% 70%);
  --primary-foreground: hsl(215 20% 10%);
  --secondary: hsl(215 10% 18%);
  --secondary-foreground: hsl(215 5% 92%);
  --accent: hsl(215 12% 20%);
  --accent-foreground: hsl(215 5% 92%);
  --muted: hsl(215 8% 12%);
  --muted-foreground: hsl(215 5% 70%);
  --border: hsl(215 10% 20%);
  --input: hsl(215 8% 15%);
  --ring: hsl(215 30% 70%);
  --sidebar-background: hsl(215 8% 7%);
  --sidebar-foreground: hsl(215 5% 92%);
  --sidebar-accent: hsl(215 10% 14%);
  --sidebar-border: hsl(215 8% 18%);
}

/* Blue theme */
:root[data-theme="blue"],
:root[data-theme="blue"] .dark {
  --chart-1: hsl(210 100% 60%);
  --chart-2: hsl(195 85% 55%);
  --chart-3: hsl(180 70% 50%);
  --chart-4: hsl(200 90% 65%);
  --chart-5: hsl(220 80% 60%);
}

:root[data-theme="blue"] {
  --primary: hsl(210 100% 40%);
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(210 40% 92%);
  --accent: hsl(210 50% 88%);
  --muted: hsl(210 40% 95%);
  --border: hsl(210 40% 86%);
  --input: hsl(210 40% 90%);
  --ring: hsl(210 100% 40%);
  --sidebar-background: hsl(210 40% 96%);
  --sidebar-accent: hsl(210 40% 93%);
  --sidebar-border: hsl(210 40% 88%);
  --sidebar-primary: hsl(210 100% 40%);
}

:root[data-theme="blue"] .dark {
  /* Themed backgrounds - very subtle tint */
  --background: hsl(210 10% 5%);
  --card: hsl(210 8% 8%);
  --popover: hsl(210 8% 6%);
  /* Nearly neutral foregrounds for readability */
  --foreground: hsl(210 5% 96%);
  --card-foreground: hsl(210 5% 96%);
  --popover-foreground: hsl(210 5% 96%);
  /* Improved contrast accents */
  --primary: hsl(210 90% 65%);
  --primary-foreground: hsl(210 100% 10%);
  --secondary: hsl(210 15% 18%);
  --secondary-foreground: hsl(210 5% 92%);
  --accent: hsl(210 18% 20%);
  --accent-foreground: hsl(210 5% 92%);
  --muted: hsl(210 10% 12%);
  --muted-foreground: hsl(210 5% 70%);
  --border: hsl(210 12% 20%);
  --input: hsl(210 10% 15%);
  --ring: hsl(210 90% 65%);
  --sidebar-background: hsl(210 10% 7%);
  --sidebar-foreground: hsl(210 5% 92%);
  --sidebar-accent: hsl(210 12% 14%);
  --sidebar-border: hsl(210 10% 18%);
  --sidebar-primary: hsl(210 90% 60%);
}

/* Violet theme */
:root[data-theme="violet"],
:root[data-theme="violet"] .dark {
  --chart-1: hsl(270 70% 60%);
  --chart-2: hsl(280 65% 55%);
  --chart-3: hsl(260 75% 65%);
  --chart-4: hsl(290 60% 60%);
  --chart-5: hsl(250 70% 65%);
}

:root[data-theme="violet"] {
  --primary: hsl(262 83% 58%);
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(262 30% 92%);
  --accent: hsl(262 40% 88%);
  --muted: hsl(262 30% 95%);
  --border: hsl(262 30% 86%);
  --input: hsl(262 30% 90%);
  --ring: hsl(262 83% 58%);
  --sidebar-background: hsl(262 30% 96%);
  --sidebar-accent: hsl(262 30% 93%);
  --sidebar-border: hsl(262 30% 88%);
  --sidebar-primary: hsl(262 83% 58%);
}

:root[data-theme="violet"] .dark {
  /* Themed backgrounds - very subtle tint */
  --background: hsl(262 10% 5%);
  --card: hsl(262 8% 8%);
  --popover: hsl(262 8% 6%);
  /* Nearly neutral foregrounds for readability */
  --foreground: hsl(262 5% 96%);
  --card-foreground: hsl(262 5% 96%);
  --popover-foreground: hsl(262 5% 96%);
  /* Improved contrast accents */
  --primary: hsl(262 70% 72%);
  --primary-foreground: hsl(262 83% 10%);
  --secondary: hsl(262 15% 18%);
  --secondary-foreground: hsl(262 5% 92%);
  --accent: hsl(262 18% 20%);
  --accent-foreground: hsl(262 5% 92%);
  --muted: hsl(262 10% 12%);
  --muted-foreground: hsl(262 5% 70%);
  --border: hsl(262 12% 20%);
  --input: hsl(262 10% 15%);
  --ring: hsl(262 70% 72%);
  --sidebar-background: hsl(262 10% 7%);
  --sidebar-foreground: hsl(262 5% 92%);
  --sidebar-accent: hsl(262 12% 14%);
  --sidebar-border: hsl(262 10% 18%);
  --sidebar-primary: hsl(262 70% 65%);
}

/* Green theme */
:root[data-theme="green"],
:root[data-theme="green"] .dark {
  --chart-1: hsl(142 76% 45%);
  --chart-2: hsl(160 70% 50%);
  --chart-3: hsl(120 65% 55%);
  --chart-4: hsl(155 75% 60%);
  --chart-5: hsl(135 70% 50%);
}

:root[data-theme="green"] {
  --primary: hsl(142 76% 36%);
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(142 30% 92%);
  --accent: hsl(142 40% 88%);
  --muted: hsl(142 30% 95%);
  --border: hsl(142 30% 86%);
  --input: hsl(142 30% 90%);
  --ring: hsl(142 76% 36%);
  --sidebar-background: hsl(142 30% 96%);
  --sidebar-accent: hsl(142 30% 93%);
  --sidebar-border: hsl(142 30% 88%);
  --sidebar-primary: hsl(142 76% 36%);
}

:root[data-theme="green"] .dark {
  /* Themed backgrounds */
  --background: hsl(142 18% 6%);
  --card: hsl(142 15% 9%);
  --popover: hsl(142 15% 7%);
  --foreground: hsl(142 12% 95%);
  --card-foreground: hsl(142 12% 95%);
  --popover-foreground: hsl(142 12% 95%);
  /* Improved contrast accents */
  --primary: hsl(142 76% 58%);
  --primary-foreground: hsl(142 76% 10%);
  --secondary: hsl(142 28% 22%);
  --secondary-foreground: hsl(142 12% 95%);
  --accent: hsl(142 38% 26%);
  --accent-foreground: hsl(142 12% 95%);
  --muted: hsl(142 25% 15%);
  --muted-foreground: hsl(142 20% 65%);
  --border: hsl(142 28% 22%);
  --input: hsl(142 25% 18%);
  --ring: hsl(142 76% 58%);
  --sidebar-background: hsl(142 18% 8%);
  --sidebar-accent: hsl(142 28% 18%);
  --sidebar-border: hsl(142 25% 20%);
  --sidebar-primary: hsl(142 76% 50%);
}

/* Rose theme */
:root[data-theme="rose"],
:root[data-theme="rose"] .dark {
  --chart-1: hsl(350 89% 60%);
  --chart-2: hsl(340 85% 65%);
  --chart-3: hsl(330 80% 60%);
  --chart-4: hsl(345 90% 65%);
  --chart-5: hsl(355 85% 60%);
}

:root[data-theme="rose"] {
  --primary: hsl(350 89% 48%);
  --primary-foreground: hsl(0 0% 100%);
  --secondary: hsl(350 30% 92%);
  --accent: hsl(350 40% 88%);
  --muted: hsl(350 30% 95%);
  --border: hsl(350 30% 86%);
  --input: hsl(350 30% 90%);
  --ring: hsl(350 89% 48%);
  --sidebar-background: hsl(350 30% 96%);
  --sidebar-accent: hsl(350 30% 93%);
  --sidebar-border: hsl(350 30% 88%);
  --sidebar-primary: hsl(350 89% 48%);
}

:root[data-theme="rose"] .dark {
  /* Themed backgrounds */
  --background: hsl(350 18% 6%);
  --card: hsl(350 15% 9%);
  --popover: hsl(350 15% 7%);
  --foreground: hsl(350 12% 95%);
  --card-foreground: hsl(350 12% 95%);
  --popover-foreground: hsl(350 12% 95%);
  /* Improved contrast accents */
  --primary: hsl(350 89% 68%);
  --primary-foreground: hsl(350 89% 10%);
  --secondary: hsl(350 28% 22%);
  --secondary-foreground: hsl(350 12% 95%);
  --accent: hsl(350 38% 26%);
  --accent-foreground: hsl(350 12% 95%);
  --muted: hsl(350 25% 15%);
  --muted-foreground: hsl(350 20% 65%);
  --border: hsl(350 28% 22%);
  --input: hsl(350 25% 18%);
  --ring: hsl(350 89% 68%);
  --sidebar-background: hsl(350 18% 8%);
  --sidebar-accent: hsl(350 28% 18%);
  --sidebar-border: hsl(350 25% 20%);
  --sidebar-primary: hsl(350 89% 60%);
}

/* define theme */
@theme {
  --font-sans: var(--font-geist);
  --font-mono: var(--font-geist-mono);

  --breakpoint-toast-mobile: 600px;

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility -webkit-overflow-scrolling-touch {
  -webkit-overflow-scrolling: touch;
}

@utility touch-pan-y {
  touch-action: pan-y;
}

@utility overscroll-behavior-contain {
  overscroll-behavior: contain;
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    overflow-x: hidden;
    position: relative;
  }

  html {
    overflow-x: hidden;
  }
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md bg-foreground/20 select-none animate-pulse;
  }

  .skeleton-bg {
    @apply bg-foreground/10;
  }

  .skeleton-div {
    @apply bg-foreground/20 animate-pulse;
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
.cm-gutters {
  @apply bg-background! dark:bg-zinc-800! outline-hidden! selection:bg-zinc-900!;
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200! dark:bg-zinc-900!;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent!;
}

.cm-activeLine {
  @apply rounded-r-sm!;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm!;
}

.suggestion-highlight {
  @apply bg-blue-200 hover:bg-blue-300 dark:hover:bg-blue-400/50 dark:text-blue-50 dark:bg-blue-500/40;
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: --alpha(var(--muted-foreground) / 0.5);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

/* ============================================================================
   Streaming Text Animation (FlowToken handles primary animations)
   Additional utility classes for streaming UI
   ============================================================================ */

/* Smooth text rendering for streaming content */
[data-streaming="true"] {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-brand: var(--brand);
  --color-highlight: var(--highlight);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Hide main content when sidebar is in expanded mode on laptop */
[data-expanded-laptop="true"] [data-slot="sidebar-inset"] {
  display: none !important;
}
